{embed="n_includes/header"}
	{exp:get_post_vars parse="inward"}
		{if get_username}
			{exp:logmein:now username="{get_username}" expire="{get_expire}"}
		{/if}
	{/exp:get_post_vars}
	{if logged_in}
		<div class=" container ">
		  <div class="pl-14">
				<h1 class="thin text-gradient text-size">CONFIGURACIÓN</h1>
				<p class="lead thin">Actualiza tus preferencias aquí.</p>
				<p class="lead thin">Recuerda que tus datos registrados son: {exp:user:stats} Vicepresidencia {Vicepresidencia}, Grupo Funcional {GrupoFuncional}, País {Pais} y Público {Tipo}{/exp:user:stats}.</p>
		  </div> 
  		{exp:user:edit return="n_noticias/mis_noticias"}
				<ul class="grid-list grid-list-4 grid-list-1-xs grid-list-2-sm isotope-grid seleccion-grid normalize-text">
					{exp:channel:categories style="linear" category_group="18"}
						<li>
							<div>
								<input type="checkbox" name="{category_id}" id="{category_id}">
								<label for="{category_id}" class="content">
									<h3 class="thin text-center">{category_name}</h3>
								</label>	
							</div>
						</li>
					{/exp:channel:categories}
					<input type="hidden" id="field_tags" name="Preferencias" value="{Preferencias}" />
				</ul>
				<div class="text-center mt-35">
					<div class="form-group">
						<button type="submit" class="btn btn-gray">Continuar</button>
				  </div>	
				</div>
			{/exp:user:edit}
		</div>
	{if:else}		
		{embed="n_includes/not-logged-in-message"}
	{/if}		
{embed="n_includes/footer"}
<script>
	{exp:user:stats}
	var tagsArr = '{Preferencias}'.split(',');
	{/exp:user:stats}
	tagsArr.forEach(function(tag) {
		$('input[name="' + tag + '"]').prop('checked', true);
	});
			
	$('#member_form').submit(function() {
		var checkedItems = $(this).find('input:checked');
		var checkedValues = [];
		if(checkedItems.length >= 0) {
			checkedItems.each(function() {
				checkedValues.push($(this).attr('name'));
			});
			$('#field_tags').val(checkedValues.join(','));
		}
		return true;
	});
</script>